<div class="max-w-2xl mx-auto p-6">
    <!-- Header -->
    <div class="mb-6">
        <h1 class="text-3xl font-bold text-gray-900">
            {{ isEditMode ? 'Editar Usuario' : 'Nuevo Usuario' }}
        </h1>
        <p class="text-gray-600 mt-1">
            {{ isEditMode ? 'Modifica los datos del usuario' : 'Completa los datos para crear un nuevo usuario' }}
        </p>
    </div>

    <!-- Formulario -->
    <form [formGroup]="userForm" (ngSubmit)="onSubmit()" class="bg-white rounded-lg shadow p-6 space-y-6">

        <!-- Nombres -->
        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
            <div>
                <label class="block text-sm font-medium text-gray-700 mb-2">
                    Nombre <span class="text-red-500">*</span>
                </label>
                <input type="text" formControlName="firstName"
                    class="w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent"
                    [class.border-red-500]="hasError('firstName', 'required') || hasError('firstName', 'minlength')"
                    placeholder="Juan">
                <p *ngIf="hasError('firstName', 'required')" class="text-red-500 text-sm mt-1">
                    El nombre es requerido
                </p>
                <p *ngIf="hasError('firstName', 'minlength')" class="text-red-500 text-sm mt-1">
                    Mínimo 2 caracteres
                </p>
            </div>

            <div>
                <label class="block text-sm font-medium text-gray-700 mb-2">
                    Apellido <span class="text-red-500">*</span>
                </label>
                <input type="text" formControlName="lastName"
                    class="w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent"
                    [class.border-red-500]="hasError('lastName', 'required') || hasError('lastName', 'minlength')"
                    placeholder="Pérez">
                <p *ngIf="hasError('lastName', 'required')" class="text-red-500 text-sm mt-1">
                    El apellido es requerido
                </p>
                <p *ngIf="hasError('lastName', 'minlength')" class="text-red-500 text-sm mt-1">
                    Mínimo 2 caracteres
                </p>
            </div>
        </div>

        <!-- Email -->
        <div>
            <label class="block text-sm font-medium text-gray-700 mb-2">
                Email <span class="text-red-500">*</span>
            </label>
            <input type="email" formControlName="email"
                class="w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent"
                [class.border-red-500]="hasError('email', 'required') || hasError('email', 'email')"
                placeholder="usuario@ejemplo.com">
            <p *ngIf="hasError('email', 'required')" class="text-red-500 text-sm mt-1">
                El email es requerido
            </p>
            <p *ngIf="hasError('email', 'email')" class="text-red-500 text-sm mt-1">
                Email inválido
            </p>
        </div>

        <!-- Contraseña -->
        <div>
            <label class="block text-sm font-medium text-gray-700 mb-2">
                {{ isEditMode ? 'Nueva Contraseña (dejar en blanco para no cambiar)' : 'Contraseña' }}
                <span *ngIf="!isEditMode" class="text-red-500">*</span>
            </label>
            <div class="relative">
                <input [type]="showPassword ? 'text' : 'password'" formControlName="password"
                    class="w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent pr-10"
                    [class.border-red-500]="hasError('password', 'required') || hasError('password', 'minlength')"
                    placeholder="••••••••">
                <button type="button" (click)="togglePasswordVisibility()"
                    class="absolute right-3 top-1/2 -translate-y-1/2 text-gray-500 hover:text-gray-700">
                    <i [class]="showPassword ? 'fas fa-eye-slash' : 'fas fa-eye'"></i>
                </button>
            </div>
            <p *ngIf="hasError('password', 'required')" class="text-red-500 text-sm mt-1">
                La contraseña es requerida
            </p>
            <p *ngIf="hasError('password', 'minlength')" class="text-red-500 text-sm mt-1">
                Mínimo 6 caracteres
            </p>
        </div>

        <!-- Estado -->
        <div>
            <label class="flex items-center cursor-pointer">
                <input type="checkbox" formControlName="isActive"
                    class="w-5 h-5 text-primary border-gray-300 rounded focus:ring-primary">
                <span class="ml-3 text-sm font-medium text-gray-700">Usuario activo</span>
            </label>
            <p class="text-gray-500 text-sm mt-1">
                Los usuarios inactivos no podrán iniciar sesión
            </p>
        </div>

        <!-- Botones -->
        <div class="flex justify-end gap-3 pt-4 border-t">
            <button type="button" (click)="cancel()" [disabled]="isLoading"
                class="px-6 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 disabled:opacity-50">
                Cancelar
            </button>
            <button type="submit" [disabled]="isLoading"
                class="btn-primary disabled:opacity-50 disabled:cursor-not-allowed">
                <i *ngIf="isLoading" class="fas fa-spinner fa-spin mr-2"></i>
                {{ isLoading ? 'Guardando...' : (isEditMode ? 'Actualizar' : 'Crear') }}
            </button>
        </div>
    </form>
</div>